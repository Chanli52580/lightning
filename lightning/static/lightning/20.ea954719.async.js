(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"2Fcx":function(e,t,n){e.exports={container:"antd-pro-components-header-dropdown-index-container"}},"2fsV":function(e,t,n){e.exports={header:"antd-pro-bsm-layouts-index-header",logo:"antd-pro-bsm-layouts-index-logo",menu:"antd-pro-bsm-layouts-index-menu",trigger:"antd-pro-bsm-layouts-index-trigger",right:"antd-pro-bsm-layouts-index-right",action:"antd-pro-bsm-layouts-index-action",search:"antd-pro-bsm-layouts-index-search",account:"antd-pro-bsm-layouts-index-account",avatar:"antd-pro-bsm-layouts-index-avatar",dark:"antd-pro-bsm-layouts-index-dark",name:"antd-pro-bsm-layouts-index-name"}},DUgY:function(e,t,n){e.exports={baseView:"antd-pro-bsm-business-pages-account-settings-base-view-baseView",left:"antd-pro-bsm-business-pages-account-settings-base-view-left",right:"antd-pro-bsm-business-pages-account-settings-base-view-right",avatar_title:"antd-pro-bsm-business-pages-account-settings-base-view-avatar_title",avatar:"antd-pro-bsm-business-pages-account-settings-base-view-avatar",button_view:"antd-pro-bsm-business-pages-account-settings-base-view-button_view"}},K3Pb:function(e,t,n){"use strict";n.r(t),function(e){var a,r,c=n("0Owb"),i=(n("eNCU"),n("pjJH")),o=(n("0yxu"),n("/r5h")),s=n("9og8"),u=n("fWQN"),l=n("mtLc"),d=n("yKVA"),m=n("879j"),p=n("k1fw"),h=(n("ascH"),n("GqlH")),b=n("oBTY"),f=n("tJVT"),v=n("WmNS"),g=n.n(v),w=n("q1tI"),y=n.n(w),O=n("55Ip"),j=n("/MKj"),E=n("RLxJ"),C=n("Hx5s"),k=n("vbsh"),V=n("jfUH"),S=n("CVtM"),x=n("ojbd"),_=n("hAcb"),N=n("mmaM"),P=n("Z3Gc"),M=function(e,t){var n={},a="";function r(e){a||0!==e.children.length||(a=e.path),e.children.forEach((function(t){n[t.path]=e.path,r(t)}))}e.forEach(r);var c=[],i=t;"/"===i&&(i=a);while(i in n)i=n[i],c.push(i);return{openKeys:c,first:a}};function $(t){var n=t.children,a=t.location.pathname,r=t.onOpenChange,c=t.menus,i=t.openKeys,o=t.breadcrumbByPath,s=t.logo,u=t.title,l=!Object(V["ib"])(),d=Object(w["useState"])(l),m=Object(f["a"])(d,2),p=m[0],v=m[1],g=a.split("/").filter((function(e){return e})),j=g.map((function(e,t){return"/".concat(g.slice(0,t+1).join("/"))})),E=j.reverse().find((function(e){return e in o})),k=E?[{breadcrumbName:"\u9996\u9875",path:"/"}].concat(Object(b["a"])(o[E])).map((function(t,n){return 0===n||n===o[E].length?t:e.omit(t,["path"])})):[],_={onOpenChange:r,openKeys:i},N=Object(V["v"])(s,{mode:"lfit"}),M=y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},y.a.createElement(h["a"],{message:"\u60a8\u6ca1\u6709\u4efb\u4f55\u83dc\u5355\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u8054\u7cfb\u7ba1\u7406\u5458\u7ed9\u60a8\u914d\u7f6e\u89d2\u8272",type:"warning"}));return y.a.createElement(C["d"],{logo:N||P["b"],title:u||P["f"],fixSiderbar:!0,siderWidth:256,menuHeaderRender:function(e,t){return y.a.createElement(O["a"],{to:"/"},e,t)},menuItemRender:function(e,t){return e.isUrl||e.children||!e.path?t:y.a.createElement(O["a"],{onClick:function(){return l&&v(!0)},to:e.path},t)},menuDataRender:function(e){return e.concat(c||[])},menuProps:_,breadcrumbRender:function(e,t){return t?null:k},rightContentRender:function(){return y.a.createElement(x["a"],null)},footerRender:function(){return S["a"]},collapsed:p,onCollapse:v},c&&0===c.length&&"/"===a?M:n)}var I=(a=Object(j["c"])((function(e){var t=e.setting;return Object(p["a"])({},t)})),Object(V["a"])(r=a(r=function(e){Object(d["a"])(n,e);var t=Object(m["a"])(n);function n(){var e;Object(u["a"])(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={visible:!0,passWordVisible:!1,aboutVisible:!1,openKeys:[],first:"",breadcrumbByPath:{}},e.updateMenus=function(t){var n=e.props.location.pathname,a=Object(_["a"])(t),r=Object(_["b"])(a);e.setState({menus:a,breadcrumbByPath:r}),e.setState(M(a,n))},e.onOpenChange=function(t){var n=e.state,a=n.menus,r=void 0===a?[]:a,c=n.openKeys,i=t.find((function(e){return-1===c.indexOf(e)}));if("undefined"!==typeof i){var o={};r.forEach(u);var s=t.filter((function(e){return l(e,i)})).concat([i]);e.setState({openKeys:s})}else e.setState({openKeys:t});function u(e){e.children.forEach((function(t){o[t.path]=e.path,u(t)}))}function l(e,t){return o[e]!==o[t]}},e}return Object(l["a"])(n,[{key:"componentDidMount",value:function(){var e=Object(s["a"])(g.a.mark((function e(){var t,n,a,r,c,s,u,l=this;return g.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.props,n=t.dispatch,a=t.route,r=a.routes,c=a.path,s=a.authority,Promise.all([n(window.$$userinfo&&window.$$permissions?{type:"user/saveCurrentUser",payload:Object(p["a"])(Object(p["a"])({},window.$$userinfo),{},{permissions:window.$$permissions.map(V["I"])})}:{type:"user/fetchCurrent"}),n(window.$$settings?{type:"bsmSetting/changeSettings",payload:window.$$settings}:{type:"bsmSetting/getSettings"})]).then((function(){var e,t,n=l.props,a=n.user,r=n.bsmSetting;null!==a&&void 0!==a&&null!==(e=a.currentUser)&&void 0!==e&&null!==(t=e.permissions)&&void 0!==t&&t.includes("can_web_setting__bsm_config")&&null===(null===r||void 0===r?void 0:r.DB_TIMEZONE)&&o["a"].warn({duration:null,placement:"bottomRight",message:"\u7248\u672c\u517c\u5bb9\u6027\u8b66\u544a",description:"\u672a\u8bbe\u7f6e\u65f6\u533a\uff0c\u5f53\u524d\u7248\u672c\u9700\u8981\u8bbe\u7f6e\u6570\u636e\u5e93\u65f6\u533a",key:"timezone-warning",onClick:function(){E["a"].push("/account/settings"),o["a"].close("timezone-warning")},btn:y.a.createElement(i["a"],{type:"primary"},"\u524d\u5f80\u8bbe\u7f6e")})})),n({type:"setting/getSetting"}),u=[],window.$$schemas&&window.$$admins||u.push(n({type:"content/getConfig"})),window.$$menus?this.updateMenus(window.$$menus):Promise.all([Object(N["getMenus"])()].concat(u)).then((function(e){var t=Object(f["a"])(e,1),n=t[0];return l.updateMenus(n)})),n({type:"menu/getMenuData",payload:{routes:r,path:c,authority:s}}),Object(k["c"])("bsm_config__menu",[k["b"].afterCreate,k["b"].afterUpdate,k["b"].afterDelete],(function(){n({type:"user/fetchCurrent"}),Object(N["getMenus"])().then(l.updateMenus)})),["menus","permissions","schemas","admins","userinfo","settings"].forEach((function(e){window["$".concat(e)]=window["$$".concat(e)],delete window["$$".concat(e)]}));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){return y.a.createElement($,Object(c["a"])({},this.props,this.state,{onOpenChange:this.onOpenChange}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.location.pathname,a=t.first,r=t.menus,c=void 0===r?[]:r;return a&&"/"===n?(E["a"].replace(a),M(c,n)):null}}]),n}(w["Component"]))||r)||r);t["default"]=I}.call(this,n("LvDl"))},hAcb:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));n("eE3J");var a=n("GSZB"),r=n("k1fw"),c=n("PpiC"),i=n("q1tI"),o=n.n(i),s=n("jfUH"),u={adminConfig:function(){return"/config/admin"},chart:function(){return"/dashboard/charts"},puzzle:function(e){var t=e.puzzle;return"/puzzle/".concat(t)},list:function(e){var t=e.model,n=e.view;return n?"/content/".concat(t,"/view/").concat(n):{path:"/content/".concat(t),name:"".concat(Object(s["o"])(t),"\u7ba1\u7406")}},detail:function(e){return"/content/".concat(e.model,"/detail/").concat(e.id||"__index__")},add:function(e){return"/content/".concat(e.model,"/add").concat(e.redirectPath?"?redirect_path=".concat(e.redirectPath):"")},auto:function(e){return e.path},iframe:function(e){return"/iframe/".concat(encodeURIComponent(e.path))},map:function(e){var t=e.model;return{path:"/content/".concat(t,"/map"),name:"".concat(Object(s["o"])(t),"\u7ba1\u7406")}}},l=0;function d(t){var n=t.icon,i=t.name,s=t.page,m=t.children,p=void 0===m?[]:m,h=t.params,b=Object(c["a"])(t,["icon","name","page","children","params"]);l+=1;var f="/".concat(l,"/");p.length||(f=u[s]?u[s](Object(r["a"])(Object(r["a"])({},b),h)):"/exception/404");for(var v=n||f.icon||null,g=["outlined","filled","twoTone"],w=0;w<g.length;w+=1){var y="__".concat(g[w]);if(v&&v.endsWith(y)){v=o.a.createElement(a["a"],{type:v.slice(0,-y.length),theme:"outlined"});break}}e.isString(v)&&(v=o.a.createElement(a["a"],{type:v}));var O={icon:v,name:i||f.name||"\u65e0\u540d\u83dc\u5355",path:f.path||f,children:p.map(d)};return O}function m(e){return l=0,e.map(d)}function p(e){var t={};function n(e,a){e.children.length||(t[e.path]=a.concat({breadcrumbName:e.name,path:e.path})),e.children.forEach((function(t){return n(t,a.concat({breadcrumbName:e.name,path:e.path}))}))}return e.forEach((function(e){return n(e,[])})),t}}).call(this,n("LvDl"))},ojbd:function(e,t,n){"use strict";n("52nx");var a,r,c,i=n("7bDm"),o=n("tJVT"),s=n("fWQN"),u=n("mtLc"),l=n("yKVA"),d=n("879j"),m=n("q1tI"),p=n.n(m),h=n("/MKj"),b=n("RLxJ"),f=(n("4X2C"),n("xvon")),v=(n("GPKB"),n("mFAc")),g=n("k1fw"),w=n("9og8"),y=(n("vmZS"),n("NjVP")),O=n("WmNS"),j=n.n(O),E=n("mmaM"),C=n("DUgY"),k=n.n(C),V=y["a"].Item,S=(a=Object(h["c"])((function(e){var t=e.user.currentUser;return{currentUser:t}})),r=y["a"].create(),a(c=r(c=function(e){Object(l["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;Object(s["a"])(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.setBaseInfo=function(){var t=e.props,n=t.currentUser,a=t.form;Object.keys(a.getFieldsValue()).forEach((function(e){var t={};t[e]=n[e]||null,a.setFieldsValue(t)}))},e.getViewDom=function(t){e.view=t},e.handleCancel=function(){var t=e.props.handleCancel;t()},e.handleSubmit=Object(w["a"])(j.a.mark((function t(){var n,a,r,c,i,o,s,u;return j.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.props,a=n.form,r=a.validateFields,c=a.getFieldsValue,i=n.currentUser.id,t.next=3,r((function(e){}));case 3:return t.next=5,Object(E["cloudFunction"])({model:"bsm_config__setting",functionName:"update_user_password",params:Object(g["a"])({id:i},c())});case 5:if(o=t.sent,"9000"!==o.error_code){t.next=9;break}return v["a"].error(o.error_data),t.abrupt("return");case 9:s=o.error_code,"0"!==s&&"403"!==s||(u=e.props.handleOk,u(),b["a"].push("/user/login"));case 11:case"end":return t.stop()}}),t)}))),e}return Object(u["a"])(n,[{key:"componentDidMount",value:function(){this.setBaseInfo()}},{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,n=e.visible;return p.a.createElement(i["a"],{visible:n,title:"\u5bc6\u7801\u8bbe\u7f6e",onOk:this.handleSubmit,onCancel:this.handleCancel},p.a.createElement("div",{className:k.a.baseView,ref:this.getViewDom},p.a.createElement("div",{className:k.a.left},p.a.createElement(y["a"],{layout:"vertical",onSubmit:this.handleSubmit,hideRequiredMark:!0},p.a.createElement(V,{label:"\u65e7\u5bc6\u7801"},t("oldPassWord",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801!"}]})(p.a.createElement(f["a"].Password,{placeholder:"\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801"}))),p.a.createElement(V,{label:"\u65b0\u5bc6\u7801"},t("newPassWord",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801!"}]})(p.a.createElement(f["a"].Password,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})))))))}}]),n}(m["Component"]))||c)||c),x=S,_="NA",N=n("Z3Gc"),P=n("jfUH"),M=(n("smr7"),n("DlTu")),$=(n("Ztx6"),n("8Ik2")),I=(n("eE3J"),n("GSZB")),D=(n("9kbU"),n("vbHR")),W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},H=W,U=n("6VBw"),z=function(e,t){return m["createElement"](U["a"],Object.assign({},e,{ref:t,icon:H}))};z.displayName="AppstoreAddOutlined";var A,K,R,B,F,T=m["forwardRef"](z),G=n("IAhd"),J=n("fVK0"),q=(n("qVdP"),n("jsC+")),L=n("0Owb"),Z=n("PpiC"),Q=n("TSYQ"),Y=n.n(Q),X=n("2Fcx"),ee=n.n(X),te=function(e){var t=e.overlayClassName,n=Object(Z["a"])(e,["overlayClassName"]);return p.a.createElement(q["a"],Object(L["a"])({overlayClassName:Y()(ee.a.container,t)},n))},ne=te,ae=n("2fsV"),re=n.n(ae),ce=(A=Object(h["c"])((function(e){var t=e.user.currentUser;return{currentUser:t}})),A(K=function(e){Object(l["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;Object(s["a"])(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={visible:!1},e}return Object(u["a"])(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.onMenuClick,a=t.currentUser,r=t.theme,c=t.a2sh,i=a.permissions,o=void 0===i?[]:i,s=this.state.visible,u=p.a.createElement(D["a"],{className:re.a.menu,selectedKeys:[],onClick:function(t){n(t),e.setState({visible:!1})}},c&&p.a.createElement(D["a"].Item,{key:"a2sh"},p.a.createElement(T,null),"\u6dfb\u52a0\u5230\u684c\u9762"),c&&p.a.createElement(D["a"].Divider,null),p.a.createElement(D["a"].Item,{key:"changePassword"},p.a.createElement(I["a"],{type:"form"}),"\u4fee\u6539\u5bc6\u7801"),p.a.createElement(D["a"].Divider,null),o.includes(J["a"].CHANGE_SETTING)&&p.a.createElement(D["a"].Item,{key:"webSettings"},p.a.createElement(I["a"],{type:"setting"}),Object(G["a"])({id:"menu.account.webSettings",defaultMessage:"webSettings"})),o.includes(J["a"].CHANGE_SETTING)&&p.a.createElement(D["a"].Divider,null),p.a.createElement(D["a"].Item,{key:"about"},p.a.createElement(I["a"],{type:"info-circle"}),Object(G["a"])({id:"menu.about",defaultMessage:"about"})),p.a.createElement(D["a"].Divider,null),p.a.createElement(D["a"].Item,{key:"logout"},p.a.createElement(I["a"],{type:"logout"}),Object(G["a"])({id:"menu.account.logout",defaultMessage:"logout"}))),l=re.a.right;return"dark"===r&&(l="".concat(re.a.right,"  ").concat(re.a.dark)),p.a.createElement("div",{className:l},a.username?p.a.createElement(ne,{overlay:u,visible:s,onVisibleChange:function(t){return e.setState({visible:t})},trigger:["hover","click"]},p.a.createElement("span",{className:"".concat(re.a.action," ").concat(re.a.account)},p.a.createElement($["a"],{size:"small",className:re.a.avatar,src:a.avatar,alt:"avatar",icon:!a.avatar&&"user"}),p.a.createElement("span",{className:re.a.name},a.nick_name||a.name||a.username),p.a.createElement(I["a"],{type:s?"caret-up":"caret-down",style:{marginLeft:8,fontSize:16,color:"#595959"}}))):p.a.createElement(M["a"],{size:"small",style:{marginLeft:8,marginRight:24}}))}}]),n}(m["Component"]))||K),ie=ce,oe=(R=Object(P["d"])((function(){return{a2sh:Object(P["Q"])()}})),B=Object(h["c"])((function(e){var t=e.content,n=t.release,a=t.build;return{release:n,build:a}})),R(F=B(F=function(e){Object(l["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;Object(s["a"])(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={passWordVisible:!1,aboutVisible:!1},e.handleMenuClick=function(t){var n=t.key,a=e.props,r=a.dispatch,c=Object(o["a"])(a.a2sh,2),i=c[0],s=c[1];"logout"===n&&r({type:"content/logout"}),"webSettings"===n&&b["a"].push("/account/settings"),"changePassword"===n&&e.showPassWord(),"about"===n&&e.setState({aboutVisible:!0}),"a2sh"===n&&i&&(i.prompt(),i.userChoice.then((function(e){"accepted"===e.outcome&&s(null)})))},e.handleOkPassWord=function(){e.setState({passWordVisible:!1})},e.handleCancelPassWord=function(){e.setState({passWordVisible:!1})},e.showPassWord=function(){e.setState({passWordVisible:!0})},e}return Object(u["a"])(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.release,a=t.build,r=Object(o["a"])(t.a2sh,1),c=r[0],s=this.state,u=s.passWordVisible,l=s.aboutVisible;return p.a.createElement(p.a.Fragment,null,p.a.createElement(ie,{onMenuClick:this.handleMenuClick,a2sh:c}),p.a.createElement(x,{visible:u,handleCancel:this.handleCancelPassWord,handleOk:this.handleOkPassWord}),p.a.createElement(i["a"],{title:"\u5173\u4e8e",visible:l,onOk:function(){e.setState({aboutVisible:!1})},onCancel:function(){e.setState({aboutVisible:!1})}},p.a.createElement("div",null,p.a.createElement("p",null,N["f"],"\u7cfb\u7edf\u3002\u7531\u6770\u660e\u79d1\u6280\u8363\u8a89\u51fa\u54c1\u3002"),p.a.createElement("p",null,"\u53d1\u884c\u7248\u672c\u53f7\uff1a",n),p.a.createElement("p",null,"\u524d\u7aef\u6784\u5efa\u7248\u672c\uff1a",_),p.a.createElement("p",null,"\u540e\u7aef\u6784\u5efa\u7248\u672c\uff1a",a))))}}]),n}(m["Component"]))||F)||F);t["a"]=oe}}]);