(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[43],{"9cMg":function(e,t,a){"use strict";a.r(t);a("NxO5");var r,n,l,s=a("Hcx2"),c=(a("FtyQ"),a("WvG8")),i=(a("8keV"),a("IhqU")),o=(a("DPrF"),a("KLaO")),u=a("CxVk"),m=a.n(u),p=(a("Drjx"),a("Ogxh")),d=(a("2zJo"),a("EpZc")),f=(a("Ti7s"),a("t/Nd")),g=(a("KaAb"),a("jr2x")),E=(a("uDqj"),a("X8RW")),y=a("sXdV"),h=a.n(y),v=a("q847"),b=a.n(v),k=a("dLrW"),w=a.n(k),x=a("cjXc"),S=a.n(x),C=a("3m6/"),A=a.n(C),D=a("CIpT"),L=a.n(D),q=a("QetK"),F=a.n(q),j=(a("2eh7"),a("T37F")),M=(a("HqD5"),a("4sAw")),N=a("qE61"),R=a.n(N),O=a("OaWn"),T=a.n(O),_=a("HP82"),B=a("ASN+"),P=a("R+re"),V=a.n(P);function W(e){var t=I();return function(){var a,r=F()(e);if(t){var n=F()(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return L()(this,a)}}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Q=M["a"].Item,z=j["a"].Option,H={labelCol:{xs:{span:5}},wrapperCol:{xs:{span:19}}},J={mysql:"3306",oracle:"1521",postgresql:"5432"},K="127.0.0.1",X="20002",G=["mysql","oracle","postgresql"];function U(e){var t=e.engine,a=e;return G.includes(t)&&(a.port=a.port||J[t],a.host=a.host||K),a}var Z=(r=M["a"].create(),r((l=function(e){A()(a,e);var t=W(a);function a(){var e;w()(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n)),e.state={loading:!1,isSuccessed:!1,errorCode:"",errorMessage:"",errorData:null,isSubmited:!1,alert:{message:"",description:"",type:"success"},step:"License"},e.toApp=function(){return T.a.push("/content/meta__model")},e.installApp=b()(h.a.mark(function t(){var a,r,n,l,s,c=arguments;return h.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=c.length>0&&void 0!==c[0]&&c[0],t.next=3,e.closeAlert();case 3:return r=e.props.form,n=r.getFieldsValue,l=r.validateFields,t.next=6,l();case 6:if(B["b"].valid){t.next=8;break}return t.abrupt("return");case 8:return s=U(n()),s.ignore_invalid_table=a,e.setState({loading:!0}),t.prev=11,e.setState({isSubmited:!0}),t.next=15,Object(_["y"])(s);case 15:e.setState({isSuccessed:!0}),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](11),e.setError(t.t0);case 21:e.setState({loading:!1});case 22:case"end":return t.stop()}},t,null,[[11,18]])})),e.fillAgain=function(){e.setState({errorCode:"",errorMessage:"",isSubmited:!1,isSuccessed:!1}),e.closeAlert()},e.createDataBaseCheckFailErrorMessage=function(){var t=e.state,a=t.errorData,r=t.errorMessage;return R.a.createElement("div",null,R.a.createElement("p",null,r),a.map(function(e,t){return R.a.createElement("p",{key:"".concat(e[0])},"".concat(t+1,". \u8868").concat(e[0],"\uff1a").concat(e[1].join("\uff1b")))}))},e.closeAlert=function(){return new Promise(function(t){return e.setState({alert:{message:"",description:"",type:""}},function(){return t()})})},e.createErrorMessage=function(){var t=e.state,a=t.errorCode,r=t.errorMessage,n=t.errorData,l="warning";a===X?e.showAlert(r,e.createDataBaseCheckFailErrorMessage(),l):e.showAlert(r,n,l)},e.showAlert=function(t,a,r){return e.setState({alert:{message:t,description:a,type:r}})},e.checkDatabase=b()(h.a.mark(function t(){var a,r,n,l;return h.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.props.form,r=a.getFieldsValue,n=a.validateFields,t.next=3,n();case 3:if(B["b"].valid){t.next=5;break}return t.abrupt("return");case 5:return l=U(r()),t.prev=6,t.next=9,Object(_["d"])(l);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t["catch"](6),e.setError(t.t0),t.abrupt("return");case 15:e.showAlert("\u606d\u559c\uff01\u6570\u636e\u5e93\u8fde\u63a5\u6d4b\u8bd5\u6210\u529f\u3002","","info");case 16:case"end":return t.stop()}},t,null,[[6,11]])})),e.setError=function(t){var a=t.error_message,r=t.error_code,n=t.error_data;e.setState({errorMessage:a,errorCode:r,errorData:n},function(){return e.createErrorMessage()})},e}return S()(a,[{key:"componentDidMount",value:function(){var e=b()(h.a.mark(function e(){return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(_["e"])();case 2:if(!e.sent){e.next=5;break}this.setState({isSuccessed:!0}),this.toApp();case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"handleNextStep",value:function(e){var t=this.state.step;"License"!==t||B["b"].valid?this.setState({step:e}):E["a"].error({content:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684License!",key:"License",duration:2})}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,r=t.getFieldValue,n=this.state,l=n.loading,u=n.isSubmited,E=n.isSuccessed,y=n.errorCode,h=n.alert,v=n.step;return E?R.a.createElement("div",{className:V.a.success},R.a.createElement(g["a"],{style:{fontSize:64,color:"#52c41a"},type:"check-circle",theme:"filled"}),R.a.createElement("span",{style:{fontSize:24,marginTop:8,marginBottom:32,fontWeight:"bold"}},"\u606d\u559c\uff01\u5b89\u88c5\u6210\u529f"),R.a.createElement("div",{style:{width:560,color:"#8c8c8c",fontWeight:"bold"}},R.a.createElement("div",null,"\u6211\u4eec\u4e3a\u4f60\u7684\u6570\u636e\u5e93\u914d\u7f6e\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u7ba1\u7406\u7cfb\u7edf\uff0c\u63a5\u4e0b\u6765\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u559c\u597d\u8fdb\u884c\u4e00\u4e9b\u8c03\u6821\uff0c\u4ee5\u4fbf\u5f97\u5230\u66f4\u4f73\u7684\u7ba1\u7406\u4f53\u9a8c\uff0c\u5982\uff1a"),R.a.createElement("div",{style:{marginTop:16,marginBottom:16}},R.a.createElement("div",null,"1.\u8c03\u6574\u5bfc\u822a\u680f\u83dc\u5355\u7ed3\u6784\uff0c\u8ba9\u6570\u636e\u7684\u7ec4\u7ec7\u66f4\u52a0\u6709\u6761\u7406\u3002"),R.a.createElement("div",null,"2.\u8c03\u6574\u67d0\u4e9b\u6570\u636e\u5217\u8868\u9875\u9762\u548c\u8868\u5355\u9875\u9762\u3001\u5b57\u6bb5\u751a\u81f3\u662f\u63a7\u4ef6\u7b49\u3002"),R.a.createElement("div",null,"3.\u7ed9\u81ea\u5df1\u914d\u7f6e\u4e00\u4e2a\u4eea\u8868\u677f\uff0c\u7528\u56fe\u8868\u6765\u53ef\u89c6\u5316\u4f60\u7684\u6570\u636e")),R.a.createElement("div",null,"\u66f4\u591a\u8c03\u6574\u65b9\u6cd5\uff0c\u53ef\u4ee5\u53c2\u8003\u4f7f\u7528\u6587\u6863\u3002\u5982\u679c\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6709\u7591\u95ee\uff0c\u4e5f\u53ef\u4ee5\u8054\u7cfb\u6211\u4eec\u3002")),R.a.createElement(f["a"],{type:"default",onClick:this.toApp,style:{marginTop:32}},"\u77e5\u9053\u4e86\uff0c\u8fdb\u5165\u7cfb\u7edf")):R.a.createElement("div",{style:{width:500,margin:"auto"}},"License"===v?R.a.createElement("div",{className:V.a.t1},'  \u5728\u5f00\u59cb\u524d\uff0c\u8bf7\u8f93\u5165License\uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709License\uff0c\u8bf7\u6dfb\u52a0\u5fae\u4fe1\u53f7"gitmen"\u6216\u7ed9jeff@gitmen.com\u53bb\u90ae\u4ef6\u8bf4\u660e\u6765\u610f\uff0c\u53ef\u83b7\u5f97\u8bd5\u7528\u7684License\u3002'):R.a.createElement(R.a.Fragment,null,R.a.createElement("div",{className:V.a.t1},"   \u6b22\u8fce\u4f7f\u7528\u95ea\u7535\u6570\u636e\u7ba1\u7406\u7cfb\u7edf\uff0c\u770b\u5230\u8fd9\u4e2a\u9875\u9762\u8bf4\u660e\u60a8\u5df2\u7ecf\u628a\u5b83\u6210\u529f\u8fd0\u884c\u8d77\u6765\u4e86\uff0c\u8868\u626c\uff01\n            \u73b0\u5728\u8fd8\u5dee\u4e00\u6b65\u5c31\u641e\u5b9a\u4e86: \u544a\u8bc9\u6211\u4eec\u4f60\u8981\u7ba1\u7406\u7684\u6570\u636e\u5e93\u5728\u54ea\u91cc\uff0c\u6211\u4eec\u8fde\u4e0a\u540e\u9a6c\u4e0a\u4e3a\u4f60\u5448\u73b0\u4e00\u4e2a\u9ad8\u54c1\u8d28\u7684\u7ba1\u7406\u7cfb\u7edf\u3002"),R.a.createElement("div",{className:V.a.t2},"  \u63a5\u4e0b\u6765\uff0c\u8bf7\u4e3a\u6211\u4eec\u6307\u5b9a\u4f60\u60f3\u8981\u7684\u6570\u636e\u5e93\uff0c\u8bf7\u786e\u4fdd\u5b83\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u5e76\u53ef\u4ee5\u8bbf\u95ee\u3002"),R.a.createElement("div",{className:V.a.t3},"License"===v?"":"\u4e1a\u52a1\u6570\u636e\u5e93\u914d\u7f6e")),R.a.createElement(M["a"],H,R.a.createElement("div",{style:"License"===v?{}:{display:"none"}},R.a.createElement(Q,{label:"License"},a("license",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165License"}]})(R.a.createElement(B["a"],null)),R.a.createElement("br",null)),R.a.createElement("div",null,R.a.createElement(f["a"],{type:"primary",onClick:function(){return e.handleNextStep("setDB")},style:{marginLeft:100}},"\u4e0b\u4e00\u6b65"))),R.a.createElement("div",{style:"setDB"===v?{}:{display:"none"}},R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u7c7b\u578b"},a("engine",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u7c7b\u578b"}]})(R.a.createElement(j["a"],null,R.a.createElement(z,{key:"sqlite"},"SQLite"),R.a.createElement(z,{key:"mysql"},"MySQL"),R.a.createElement(z,{key:"oracle"},"Oracle"),R.a.createElement(z,{key:"postgresql"},"PostgreSQL")))),R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u540d\u79f0"},a("db_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u540d\u79f0"}]})(R.a.createElement(d["a"],null))),G.includes(r("engine"))&&R.a.createElement(R.a.Fragment,null,R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u7528\u6237"},a("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u7528\u6237"}]})(R.a.createElement(d["a"],null))),R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u5bc6\u7801"},a("password",{})(R.a.createElement(d["a"],{type:"password",allowClear:!0}))),R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u5730\u5740"},a("host",{})(R.a.createElement(d["a"],{placeholder:"\u9ed8\u8ba4\u4e3a\uff1a".concat(K),allowClear:!0}))),R.a.createElement(Q,{label:"\u6570\u636e\u5e93\u7aef\u53e3"},a("port",{})(R.a.createElement(p["a"],{placeholder:"\u9ed8\u8ba4:".concat(J[r("engine")])})))),h.message&&R.a.createElement("div",null,y&&u&&R.a.createElement("div",{style:{color:"#f5222d",marginBottom:16}},y===X?"\u5b89\u88c5\u8fc7\u7a0b\u6211\u4eec\u68c0\u6d4b\u5230\u4e00\u4e9b\u95ee\u9898\uff0c\u4e0d\u5f71\u54cd\u7cfb\u7edf\u7684\u5b89\u88c5\uff0c\u4f46\u53ef\u80fd\u5bf9\u529f\u80fd\u6709\u5f71\u54cd\uff0c\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u51b3\u7edd\u540e\u91cd\u8bd5\uff0c\u4e5f\u53ef\u4ee5\u5ffd\u7565\u8fd9\u4e9b\u8b66\u544a\u7ee7\u7eed\u5b89\u88c5\u3002":"\u5b89\u88c5\u8fc7\u7a0b\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u8bf7\u5148\u4fee\u6b63\u518d\u7ee7\u7eed\uff0c\u5982\u679c\u6709\u7591\u95ee\u8bf7\u8054\u7cfb\u6211\u4eec"),R.a.createElement(o["a"],m()({},h,{showIcon:!0}))),!l&&u&&!E&&R.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:48}},R.a.createElement(c["a"],{type:"flex",justify:"center"},R.a.createElement(i["a"],null,R.a.createElement(f["a"],{type:"default",onClick:this.fillAgain},"\u91cd\u65b0\u586b\u5199"),R.a.createElement(f["a"],{type:"primary",onClick:function(){return e.installApp()},style:{marginRight:8,marginLeft:8}},"\u91cd\u8bd5"),y===X&&R.a.createElement(f["a"],{type:"default",onClick:function(){return e.installApp(!0)}},"\u5ffd\u7565\u8b66\u544a\u7ee7\u7eed\u5b89\u88c5")))),R.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:48}},R.a.createElement(s["a"],{spinning:l,size:"large",tip:"\u521d\u59cb\u5316\u6570\u636e\u5e93..."}),!u&&R.a.createElement("div",null,R.a.createElement(f["a"],{style:{marginRight:10},onClick:this.checkDatabase},"\u8fde\u63a5\u6d4b\u8bd5"),R.a.createElement(f["a"],{type:"primary",onClick:function(){return e.installApp()}},"\u5f00\u59cb\u5427"))))))}}]),a}(N["PureComponent"]),n=l))||n);t["default"]=Z},"R+re":function(e,t,a){e.exports={t1:"antd-pro-pages-user-install-t1",t2:"antd-pro-pages-user-install-t2",t3:"antd-pro-pages-user-install-t3",success:"antd-pro-pages-user-install-success"}}}]);